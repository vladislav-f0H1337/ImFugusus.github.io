<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Fugu Elite TWA + Store</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --purp: #bc13fe;
            --org: #ff9e00;
            --glass: rgba(255, 255, 255, 0.07);
            --border: rgba(255, 255, 255, 0.1);
        }

        body {
            font-family: 'Segoe UI', Roboto, sans-serif;
            background: radial-gradient(circle at top, #1a0b2e 0%, #050505 100%);
            color: white; margin: 0; padding: 0;
            display: flex; flex-direction: column; align-items: center;
            min-height: 100vh; overflow-x: hidden; touch-action: manipulation;
        }

        #audio-unlock {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); z-index: 9999;
            display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center;
        }

        header {
            width: 100%; padding: 25px 0; background: var(--glass);
            backdrop-filter: blur(15px); border-bottom: 1px solid var(--border);
            text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .user-badge {
            display: inline-block; padding: 5px 15px; border-radius: 20px;
            background: linear-gradient(90deg, var(--purp), #7a0bc0);
            font-weight: bold; font-size: 0.9rem; cursor: pointer; box-shadow: 0 0 15px var(--purp);
        }

        .main-score {
            font-size: 3.5rem; font-weight: 900; margin: 15px 0;
            background: linear-gradient(to bottom, #fff, var(--org));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            filter: drop-shadow(0 0 15px rgba(255, 158, 0, 0.4));
        }

        .fugu-main {
            font-size: 140px; cursor: pointer; transition: transform 0.1s;
            filter: drop-shadow(0 0 40px var(--purp));
            animation: fuguFloat 4s infinite ease-in-out;
        }
        @keyframes fuguFloat {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-15px) rotate(3deg); }
        }
        .fugu-main:active { transform: scale(0.85); }

        .glass-card {
            background: var(--glass); backdrop-filter: blur(10px);
            border: 1px solid var(--border); border-radius: 24px;
            width: 90%; max-width: 400px; padding: 20px; margin-bottom: 20px; box-sizing: border-box;
        }

        .btn-premium {
            background: linear-gradient(45deg, var(--org), #ff5e00);
            border: none; color: white; width: 100%; padding: 18px;
            border-radius: 15px; font-size: 1.1rem; font-weight: bold;
            text-transform: uppercase; cursor: pointer; margin-top: 10px;
        }

        /* –ú–ê–ì–ê–ó–ò–ù */
        .store-item {
            display: flex; justify-content: space-between; align-items: center;
            padding: 15px; background: rgba(255,255,255,0.05);
            border-radius: 15px; margin-bottom: 10px; border: 1px solid var(--border);
        }
        .store-info h4 { margin: 0; color: var(--org); }
        .store-info p { margin: 0; font-size: 0.75rem; opacity: 0.7; }
        
        .buy-btn {
            background: var(--purp); border: none; color: white;
            padding: 8px 12px; border-radius: 8px; font-weight: bold; cursor: pointer;
        }
        .buy-btn:disabled { background: #444; opacity: 0.5; }

        .plus-one {
            position: absolute; font-weight: bold; color: var(--org);
            pointer-events: none; animation: flyUp 0.6s forwards; font-size: 1.5rem;
        }
        @keyframes flyUp {
            0% { transform: translateY(0); opacity: 1; }
            100% { transform: translateY(-120px); opacity: 0; }
        }
    </style>
</head>
<body>

<div id="audio-unlock" onclick="startApp()">
    <h1 style="color:var(--org)">FUGU ELITE</h1>
    <p>–í–•–û–î –í –õ–û–ì–û–í–û<br><small>(–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –∑–≤—É–∫ F1)</small></p>
</div>

<header>
    <div class="user-badge" id="user-display" onclick="changeNick()">üëë –ó–∞–≥—Ä—É–∑–∫–∞...</div>
</header>

<div class="main-score" id="score">0</div>
<div style="font-size: 0.9rem; margin-top: -10px; opacity: 0.6;" id="cps-info">–î–æ—Ö–æ–¥: 0/—Å–µ–∫</div>

<div style="position:relative; margin: 20px 0;">
    <div class="fugu-main" id="clicker">üê°</div>
</div>

<div class="glass-card">
    <h3 style="margin:0 0 15px 0; color:var(--org); text-align:center;">üõí UPGRADE STORE</h3>
    
    <div class="store-item">
        <div class="store-info">
            <h4>–ó–æ–ª–æ—Ç–æ–π –ü–∞–ª–µ—Ü</h4>
            <p id="click-lv">–£—Ä. 1 (+1 –∑–∞ –∫–ª–∏–∫)</p>
        </div>
        <button class="buy-btn" onclick="buyUpgrade('click')" id="btn-click-buy">–¶–µ–Ω–∞: 100</button>
    </div>

    <div class="store-item">
        <div class="store-info">
            <h4>–§—É–≥—É-–ë–æ—Ç</h4>
            <p id="auto-lv">–£—Ä. 0 (+1/—Å–µ–∫ –ø–∞—Å—Å–∏–≤–Ω–æ)</p>
        </div>
        <button class="buy-btn" onclick="buyUpgrade('auto')" id="btn-auto-buy">–¶–µ–Ω–∞: 500</button>
    </div>
</div>

<div class="glass-card">
    <div style="text-align:center; opacity:0.7; font-size:0.8rem; letter-spacing:2px">CASINO ROYALE</div>
    <div style="display:flex; justify-content:center; gap:15px; font-size:3rem; margin:15px 0;">
        <div id="s1">üé≤</div><div id="s2">üé≤</div><div id="s3">üé≤</div>
    </div>
    <button class="btn-premium" onclick="spin()">–ö—Ä—É—Ç–∏—Ç—å (500)</button>
</div>

<div class="glass-card">
    <h4 style="margin:0 0 15px 0; color:var(--purp)">MEME COLLECTION</h4>
    <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
        <img src="IMG_20260101_145849_625.jpg" style="width:100%; border-radius:10px;">
        <img src="IMG_20260101_145923_474.jpg" style="width:100%; border-radius:10px;">
        <img src="IMG_20260101_145902_173.jpg" style="width:100%; border-radius:10px;">
        <img src="IMG_20260101_151706_375.jpg" style="width:100%; border-radius:10px;">
    </div>
</div>

<audio id="f1-sound" src="f1_radio_sound-293747.mp3" preload="auto"></audio>

<script>
    const tg = window.Telegram.WebApp;
    tg.expand();

    let balance = parseInt(localStorage.getItem('fugu_bal')) || 0;
    let nick = localStorage.getItem('fugu_nick') || tg.initDataUnsafe?.user?.first_name || "–ë–æ—Å—Å";
    
    // –î–∞–Ω–Ω—ã–µ –º–∞–≥–∞–∑–∏–Ω–∞
    let clickLv = parseInt(localStorage.getItem('fugu_click_lv')) || 1;
    let autoLv = parseInt(localStorage.getItem('fugu_auto_lv')) || 0;

    const sound = document.getElementById('f1-sound');

    function startApp() {
        document.getElementById('audio-unlock').style.display = 'none';
        playSound();
        setInterval(processAutoIncome, 1000); // –ü–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥ —Ä–∞–∑ –≤ —Å–µ–∫—É–Ω–¥—É
    }

    function playSound() {
        sound.currentTime = 0;
        sound.play().catch(e => {});
    }

    function updateUI() {
        document.getElementById('score').innerText = Math.floor(balance).toLocaleString();
        document.getElementById('user-display').innerText = `üëë ${nick}`;
        document.getElementById('cps-info').innerText = `–î–æ—Ö–æ–¥: ${autoLv}/—Å–µ–∫ | –°–∏–ª–∞ –∫–ª–∏–∫–∞: ${clickLv}`;
        
        // –ö–Ω–æ–ø–∫–∏ –º–∞–≥–∞–∑–∏–Ω–∞
        const clickPrice = clickLv * 150;
        const autoPrice = (autoLv + 1) * 600;
        
        document.getElementById('btn-click-buy').innerText = `–¶–µ–Ω–∞: ${clickPrice}`;
        document.getElementById('btn-auto-buy').innerText = `–¶–µ–Ω–∞: ${autoPrice}`;
        document.getElementById('click-lv').innerText = `–£—Ä. ${clickLv} (+${clickLv} –∑–∞ –∫–ª–∏–∫)`;
        document.getElementById('auto-lv').innerText = `–£—Ä. ${autoLv} (+${autoLv}/—Å–µ–∫)`;

        localStorage.setItem('fugu_bal', balance);
        localStorage.setItem('fugu_nick', nick);
        localStorage.setItem('fugu_click_lv', clickLv);
        localStorage.setItem('fugu_auto_lv', autoLv);
    }

    function buyUpgrade(type) {
        if(type === 'click') {
            let price = clickLv * 150;
            if(balance >= price) {
                balance -= price; clickLv++; playSound();
            }
        } else {
            let price = (autoLv + 1) * 600;
            if(balance >= price) {
                balance -= price; autoLv++; playSound();
            }
        }
        updateUI();
    }

    function processAutoIncome() {
        if(autoLv > 0) {
            balance += autoLv;
            updateUI();
        }
    }

    document.getElementById('clicker').onclick = (e) => {
        balance += clickLv;
        updateUI();
        tg.HapticFeedback.impactOccurred('medium');
        const p = document.createElement('div');
        p.className = 'plus-one'; p.innerText = `+${clickLv}`;
        p.style.left = e.clientX + 'px'; p.style.top = e.clientY + 'px';
        document.body.appendChild(p);
        setTimeout(() => p.remove(), 600);
    };

    function spin() {
        if(balance < 500) return tg.showAlert("–ú–∞–ª–æ –¥–µ–Ω–µ–≥!");
        balance -= 500; updateUI(); playSound();
        let it = 0; const syms = ['üíé','üê°','ü§°','üíÄ','üî•'];
        const timer = setInterval(() => {
            document.getElementById('s1').innerText = syms[Math.floor(Math.random()*5)];
            document.getElementById('s2').innerText = syms[Math.floor(Math.random()*5)];
            document.getElementById('s3').innerText = syms[Math.floor(Math.random()*5)];
            if(++it > 15) { clearInterval(timer); checkSlots(); }
        }, 70);
    }

    function checkSlots() {
        const r = [document.getElementById('s1').innerText, document.getElementById('s2').innerText, document.getElementById('s3').innerText];
        if(r[0] === r[1] && r[1] === r[2]) {
            let w = r[0] === 'üê°' ? 50000 : 5000;
            balance += w; tg.showAlert("–í–ò–ù! +" + w);
        }
        updateUI();
    }

    function changeNick() {
        const n = prompt("–ù–æ–≤—ã–π –Ω–∏–∫:", nick);
        if(n) { nick = n; updateUI(); }
    }

    updateUI();
</script>
</body>
</html>
